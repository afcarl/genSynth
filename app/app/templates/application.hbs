
<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      {{#link-to "index" class="navbar-brand"}}
        GenSynth
      {{/link-to}}
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li {{bind-attr class="evolvePageIsActive:active"}}>
          {{#link-to "evolve"}}
            <span class="glyphicon glyphicon-plus-sign"></span> Evolve
          {{/link-to}}
        </li>

        {{#if session.isAuthenticated}}
          <li {{bind-attr class="userPageIsActive:active"}}>
            {{#link-to "user" currentUser}}
              <span class="glyphicon glyphicon-user"></span> My Instruments
            {{/link-to}}
          </li>
        {{/if}}

        {{!-- disable for submission
        <li><a href="#">(?) Find</a></li>
        <li><a href="#">(m) My Sounds</a></li>
        --}}

        <li {{bind-attr class="feedbackPageIsActive:active"}}>
          {{#link-to "feedback"}}
            Feedback
          {{/link-to}}
        </li>
        {{!--
        <li>[Fb] [G+] [Tw]</li>
        --}}

        {{#if session.isAuthenticated}}
          <li>
            <a {{ action 'invalidateSession' }}>Logout</a>
          </li>
        {{else}}
          <li>
            <a {{ action 'showLogin' }}>Login</a>
          </li>
        {{/if}}

      </ul>

      <div class="pull-right">
        <span class="toggleIcon" {{action "toggleHelp"}}>
          <span class="glyphicon glyphicon-question-sign"></span>
        </span>
        <span class="toggleIcon" {{action "toggleSettings"}}>
          <span class="glyphicon glyphicon-cog"></span>
        </span>
      </div>
      {{#if session.isAuthenticated}}
        <span class="pull-right">Logged in as {{currentUser.username}}</span>
      {{/if}}

    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<div class="mainContent">
  <div class="row">
    <div class="col-md-12">
      {{outlet}}
    </div>
  </div>
</div>

{{#if showLogin}}
  <div class="modal" {{action 'hideLogin' bubbles=false}}>
    <div class="modal-dialog" {{action 'showLogin' bubbles=false}}>
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" {{action 'hideLogin'}}><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title">Login</h4>
        </div>
        <div class="modal-body">
          <button type="button" class="btn btn-primary" {{action "authenticate" "facebook-connect"}}>Facebook</button>
          <button type="button" class="btn btn-primary" {{action "createUser"}}>CreateBlankUser</button>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" {{action 'hideLogin'}}>Close</button>
        </div>
      </div>
    </div>
  </div>
{{/if}}

{{#if showSettings}}
  <div class="genSynthModal">
    <div class="modalContent">
      <span class="toggleText pull-right" {{action "toggleSettings"}}>Close</span>
      <h4>
        <span class="glyphicon glyphicon-cog"></span> Settings
      </h4>

      Volume {{volume}}%<br>
      {{input type="range" value=globalGainLevel min=minGlobalGainLevel max=maxGlobalGainLevel step="0.1"}}<br>
      Inputs<br>
      <button type="button"
        {{action toggleOnscreenPiano}}
        {{bind-attr class=":btn :btn-primary :btn-xs usingOnscreenPiano:active"}}>Onscreen Piano</button><br>

      <br>

      <button type="button"
        {{action toggleMIDI}}
        {{bind-attr class=":btn :btn-primary :btn-xs usingMIDI:active"}}>MIDI</button><br>
      {{#if usingMIDI}}
        {{midi-selector midiSelectable=this}}
      {{/if}}
    </div>
  </div>
{{/if}}

{{#if showHelp}}
  <div class="genSynthModal">
    <div class="modalContent">
      <span class="toggleText pull-right" {{action "toggleHelp"}}>Close</span>
      <h4>
        <span class="glyphicon glyphicon-question-sign"></span> Help
      </h4>

      Click [<span class="glyphicon glyphicon-refresh"></span> REFRESH] to regenerate the current generation.<br>
      Select the children or parents instruments that you like and click [NEXT <span class="glyphicon glyphicon-step-forward"></span>] to create the next generation based on your selection.<br>
      [<span class="glyphicon glyphicon-step-backward"></span> BACK] will return to the previous set of parents but will delete the current parents.<br>
      Pressing the <span class="liveToggle"><span class="liveIcon"></span></span> for an instrument makes it Live <span class="liveToggle"><span class="liveIcon active"></span></span>, letting you play that instrument with either the onscreen piano or through MIDI.<br>
      Both the onscreen piano and MIDI can be turned on in settings <span class="toggleIcon" {{action "toggleSettings"}}><span class="glyphicon glyphicon-cog"></span></span>.<br>

      <h4>Hotkeys</h4>
      - : Back<br>
      * : Refresh<br>
      + : Next<br>
      "Enter" : Select Current Live Instrument<br>
      1-9 : Select Child Instrument as Live <span class="liveToggle"><span class="liveIcon active"></span></span><br>
      "Spacebar" : Sustain Onscreen Piano<br>
      a,s,d... : Onscreen Piano notes (written on each key)<br>
    </div>
  </div>
{{/if}}

{{#if usingMIDI}}
  {{midi-piano
    instrumentNetwork=activeInstrument.instrumentNetwork
    selectedInput=selectedMidiInput}}
{{/if}}

{{#if usingOnscreenPiano}}
  {{onscreen-piano
    instrumentNetwork=activeInstrument.instrumentNetwork}}
{{/if}}
